# Production baseline configuration
# Copy to `.env` in production and replace all placeholder secrets.

CRM_ENVIRONMENT=production
WF_ENVIRONMENT=production

# Fail closed when security settings are missing
CRM_SECURITY_FAIL_CLOSED=true
WF_SECURITY_FAIL_CLOSED=true

# Enable app auth + RBAC across service UIs/APIs
CRM_AUTH_ENABLED=true
CRM_AUTH_SECRET=CHANGE_ME_SHARED_AUTH_SECRET
CRM_AUTH_COOKIE_NAME=ml_crm_session
CRM_AUTH_COOKIE_SECURE=true
CRM_AUTH_SESSION_TTL_SECONDS=28800
CRM_AUTH_BOOTSTRAP_EMAIL=owner@example.com
CRM_AUTH_BOOTSTRAP_PASSWORD=CHANGE_ME_STRONG_PASSWORD
CRM_AUTH_BOOTSTRAP_ROLE=owner

WF_AUTH_ENABLED=true
WF_AUTH_SECRET=CHANGE_ME_SHARED_AUTH_SECRET
WF_AUTH_COOKIE_NAME=ml_wf_session
WF_AUTH_COOKIE_SECURE=true
WF_AUTH_SESSION_TTL_SECONDS=28800
WF_AUTH_BOOTSTRAP_EMAIL=owner@example.com
WF_AUTH_BOOTSTRAP_PASSWORD=CHANGE_ME_STRONG_PASSWORD
WF_AUTH_BOOTSTRAP_ROLE=owner

DASH_AUTH_ENABLED=true
DASH_AUTH_SECRET=CHANGE_ME_SHARED_AUTH_SECRET
DASH_AUTH_COOKIE_NAME=ml_dash_session
DASH_AUTH_COOKIE_SECURE=true
DASH_AUTH_SESSION_TTL_SECONDS=28800
DASH_AUTH_BOOTSTRAP_EMAIL=owner@example.com
DASH_AUTH_BOOTSTRAP_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DASH_AUTH_BOOTSTRAP_ROLE=owner

# Use production databases
CRM_DATABASE_URL=postgresql+asyncpg://maxlevel:CHANGE_ME@db:5432/maxlevel_crm
WF_DATABASE_URL=postgresql+asyncpg://maxlevel:CHANGE_ME@db:5432/maxlevel_workflows
DASH_CRM_DATABASE_URL=postgresql+asyncpg://maxlevel:CHANGE_ME@db:5432/maxlevel_crm
DASH_WF_DATABASE_URL=postgresql+asyncpg://maxlevel:CHANGE_ME@db:5432/maxlevel_workflows
DASH_HIRING_DATABASE_URL=sqlite:///hiring.db
HIRING_DB_PATH=hiring.db

# Public URLs
DASH_DASHBOARD_URL=https://dashboard.example.com
DASH_CRM_URL=https://crm.example.com
DASH_HIRING_URL=https://hiring.example.com
DASH_WORKFLOWS_URL=https://workflows.example.com

CRM_DASHBOARD_URL=https://dashboard.example.com
CRM_CRM_URL=https://crm.example.com
CRM_HIRING_URL=https://hiring.example.com
CRM_WORKFLOWS_URL=https://workflows.example.com

WF_DASHBOARD_URL=https://dashboard.example.com
WF_CRM_URL=https://crm.example.com
WF_HIRING_URL=https://hiring.example.com
WF_WORKFLOWS_URL=https://workflows.example.com

HIRING_DASHBOARD_URL=https://dashboard.example.com
HIRING_CRM_URL=https://crm.example.com
HIRING_APP_URL=https://hiring.example.com
HIRING_WORKFLOWS_URL=https://workflows.example.com

# Workflow security
# Configure at least one webhook auth method. HMAC is recommended.
WF_WEBHOOK_SIGNING_SECRET=CHANGE_ME_LONG_RANDOM_SECRET
WF_WEBHOOK_API_KEY=
WF_CHAT_API_KEY=CHANGE_ME_CHAT_API_KEY
WF_WEBHOOK_SIGNATURE_TTL_SECONDS=300

# Durable worker settings
WF_WEBHOOK_ASYNC_DISPATCH=true
WF_DISPATCH_WORKER_ENABLED=true
WF_DISPATCH_POLL_INTERVAL_SECONDS=0.5
WF_DISPATCH_MAX_ATTEMPTS=5
WF_DISPATCH_RETRY_BACKOFF_SECONDS=30

# CRM tenant protection (required in production)
CRM_TENANT_AUTH_REQUIRED=true
CRM_TENANT_TOKEN_HEADER=X-Location-Token
# Format: slug:token,slug2:token2
CRM_TENANT_ACCESS_TOKENS=example-location:CHANGE_ME_LOCATION_TOKEN

# CRM webhook verification
CRM_WEBHOOKS_VERIFY_TWILIO_SIGNATURE=true
CRM_TWILIO_AUTH_TOKEN=CHANGE_ME_TWILIO_TOKEN
CRM_SENDGRID_INBOUND_TOKEN=CHANGE_ME_SENDGRID_TOKEN

# Public form anti-spam
CRM_FORM_RATE_LIMIT_WINDOW_SECONDS=60
CRM_FORM_RATE_LIMIT_MAX_SUBMISSIONS=5
CRM_FORM_RATE_LIMIT_BLOCK_SECONDS=300
CRM_FORM_HONEYPOT_FIELD=website
CRM_FORM_MIN_SUBMIT_SECONDS=2
