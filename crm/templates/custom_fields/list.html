{% extends "base.html" %}
{% block title %}Custom Fields - {{ location.name }}{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold text-gray-900 mb-6">Custom Fields</h1>

<div class="bg-white rounded-lg shadow p-4 mb-4">
    <form method="post" action="/loc/{{ location.slug }}/custom-fields/" class="flex gap-2 items-end">
        <div class="flex-1">
            <label class="block text-xs text-gray-500 mb-1">Name</label>
            <input type="text" name="name" required placeholder="Field name" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
        </div>
        <div class="flex-1">
            <label class="block text-xs text-gray-500 mb-1">Key</label>
            <input type="text" name="field_key" required placeholder="contact.field_name" class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm">
        </div>
        <div>
            <label class="block text-xs text-gray-500 mb-1">Type</label>
            <select name="data_type" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                <option value="text">Text</option>
                <option value="number">Number</option>
                <option value="date">Date</option>
                <option value="boolean">Boolean</option>
                <option value="select">Select</option>
            </select>
        </div>
        <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-indigo-700">Add</button>
    </form>
</div>

<div class="bg-white rounded-lg shadow overflow-hidden">
    <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Key</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Type</th>
                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Entity</th>
                <th class="px-4 py-3"></th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-100">
            {% for defn in definitions %}
            <tr>
                <td class="px-4 py-3 text-sm font-medium text-gray-900">{{ defn.name }}</td>
                <td class="px-4 py-3 text-sm text-gray-600 font-mono">{{ defn.field_key }}</td>
                <td class="px-4 py-3 text-sm text-gray-600">{{ defn.data_type }}</td>
                <td class="px-4 py-3 text-sm text-gray-600">{{ defn.entity_type }}</td>
                <td class="px-4 py-3 text-right">
                    <form method="post" action="/loc/{{ location.slug }}/custom-fields/{{ defn.id }}/delete" onsubmit="return confirm('Delete field?')">
                        <button type="submit" class="text-red-400 hover:text-red-600 text-sm">Delete</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="5" class="px-4 py-8 text-center text-gray-400">No custom fields defined</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
